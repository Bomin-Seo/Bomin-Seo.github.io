---
layout: single
title:  "[Database] 무결성 제약조건"
date:   2024-05-27 09:00:00 +0900
categories: Database
author_profile: true
sidebar:
  nav: "main"
tags : 
    - Database
---

## 무결성 제약조건

### 데이터 무결성
-	데이터의 정확성 또는 유효성을 의미합니다.
-	일관된 데이터베이스 상태를 정의하는 규칙들을 묵시적 또는 명시적으로 정의합니다.
-	데이터베이스가 갱신될 때 DBMS가 자동적으로 일관성 조건을 검사하므로 응용프로그램들은 일관성 조건을 검사할 필요가 없습니다.

### 도메인 제약 조건
-	각 attribute 값이 반드시 원자값이어야 합니다. (묵시적)
-	attribute 값의 디폴트값, 가능한 값들의 범위 등을 지정할 수 있습니다.
-	데이터 형식을 통해 값들의 유형을 제한하고, CHECK 제약 조건을 통해 값들의 범위를 제한할 수 있습니다.
-	SQL2는 도메인을 명시적으로 정의하는 것을 허용하지만, ORACLE은 지원하지 않습니다.

> ##### 도메인 제약 예시
```
CREATE TABLE Persons (
    ID int NOT NULL,
    LastName varchar(255) NOTNULL,FirstName varchar(255),Age int,
    City varchar(255),
    CONSTRAINT CHK_Person CHECK(Age>=18ANDCity='Sandnes')
);
```

### 키 제약 조건         
-	키 attribute에 중복된 값이 존재해서는 안됩니다.

##### 기본 키와 엔티티 무결성 제약조건
-	엔티티 : 사람, 장소 등과 같이 독립적으로 존재하면서 고유하게 식별이 가능한 실세계의 물리적 또는 논리적 객체, 하나의 릴레이션에는 동일한 attribute를 갖는 엔티티들만 속합니다.
-	릴레이션의 기본 키를 구성하는 어떤 attribute도 널값을 가질 수 없다는 제약조건
-	대체 키에는 적용되지 않습니다.
-	사용자는 릴레이션을 생성하는 데이터정의문에서 어떤 attribute가 릴레이션의 기본 키의 구성요소인가를 DBMS에게 알려줍니다.

##### 외래키와 참조 무결성 제약조건
-	참조 무결성 제약조건은 두 릴레이션의 연관된 tuple들 사이의 일관성 유지에 사용됩니다.
-	릴레이션 사이의 관계들이 기본 키 참조를 기반으로 묵시적으로 표현되기에 중요성을 가집니다.

##### 참조 무결성 제약조건의 성립 조건 (두 조건 중 하나만 성립되면 만족됩니다.)
-	외래 키의 값이 참조되는 tuple의 기본 키 값과 같은 경우
-	참조되는 기본 키 값과 같지 않을 경우 널값을 가져야합니다.
    -	외래 키가 자신을 포함하고 있는 릴레이션의 기본 키로 구성되지 않아야 합니다.

<p align='center'><img src = "https://github.com/Bomin-Seo/project1/assets/94039896/d7426a8c-fb2b-4a8f-acf1-d5940ac7d336" height="50%" width = "50%"/></p>
 
### 무결성 제약조건의 유지
-	데이터베이스에 대한 갱신 연산은 삽입, 삭제, 수정 연산으로 구분됩니다.
-	DBMS는 각각의 갱신 연산에 대하여 데이터 베이스가 무결성 제약조건을 만족하도록 조치를 취합니다.

##### 삽입연산에서의 무결성 제약 조건 유지
-	참조되는 릴레이션에 새로운 tuple이 삽입되면 참조 무결성 제약조건은 위배되지 않지만 이외의 다른 제약 조건은 위배될 수도 있습니다.
-	참조하는 릴레이션에 새로운 tuple이 삽입되면 모든 무결성 제약 조건을 위배할 수도 있습니다.
-	제약 조건을 위배하는 삽입 연산은 DBMS가 거절함으로써 무결성을 유지합니다.

##### 삭제연산에서의 무결성 제약 조건 유지
-	참조하는 릴레이션에서의 tuple 삭제는 모든 제약 조건을 위배하지 않습니다.
-	참조되는 릴레이션에서의 삭제는 참조 무결성 제약 조건을 위배할 수도 있습니다.

### 참조 무결성 제약조건을 만족시키기 위해서 DBMS가 제공하는 옵션

##### 제한 
-	위배를 야기한 연산을 단순히 거절합니다.

##### 연쇄(CASCADE) 
-	참조되는 릴레이션에서 tuple을 삭제하고, 참조하는 릴레이션에서 이 tuple을 참조하는 tuple들도 함께 삭제합니다.

##### 널값
-	참조되는 릴레이션에서 tuple을 삭제하고, 참조하는 릴레이션에는 외래 키에 널값을 삽입합니다.

##### 디폴트값
-	널값을 넣는 대신에 디폴트 값을 삽입합니다.

```
ON DELETE {NO ACTION | CASCADE | SET NULL | SET DEFAULT}
```
 
##### 수정연산에서의 무결성 제약 조건 유지
- DBMS가 수정하는 attribute가 기본 키인지 외래 키인지 검사합니다.
- 수정 대상 attribute가 기본키/외래키가 아니면 수정 연산은 참조 무결성 조건을 위배하지 않습니다.
- 기본키나 외래키를 수정하는 것은 삭제하고 삽입하는 것과 같으므로 위의 방법이 적용됩니다.
- Oracle에서는 기본 키 수정을 금지하고 있습니다.
